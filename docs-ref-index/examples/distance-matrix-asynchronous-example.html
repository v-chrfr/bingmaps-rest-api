<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Distance Matrix Asynchronous Example | Microsoft Docs </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Distance Matrix Asynchronous Example | Microsoft Docs ">
    <meta name="generator" content="docfx 2.36.1.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="">
    <meta property="docfx:tocrel" content="TOC.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="distance-matrix-asynchronous-example">Distance Matrix Asynchronous Example</h1>

<p>This example returns a simple driving based distance matrix for the set of origins and destinations for a specified time, June 15<sup>th</sup>, 2017 at 1PM PST. This request will automatically use predictive traffic data to provide accurate estimates. This example shows the complete asynchronous request process from the initial request, and checking the status until completed. Both a GET and its equivalent POST request are shown. Responses are shown for both XML and JSON formats.</p>
<p><strong>HTTP GET Request URL</strong></p>
<pre><code>https://dev.virtualearth.net/REST/v1/Routes/DistanceMatrixAsync?origins=47.6044,-122.3345;47.6731,-122.1185;47.6149,-122.1936&amp;destinations=45.5347,-122.6231;47.4747,-122.2057&amp;travelMode=driving&amp;startTime=2017-06-15T13:00:00-07:00&amp;key=BingMapsKey
</code></pre><p><strong>HTTP POST Request URL</strong></p>
<pre><code>https://dev.virtualearth.net/REST/v1/Routes/DistanceMatrixAsync?key=BingMapsKey
</code></pre><p>HTTP POST Header</p>
<pre><code>Content-Length: 497
Content-Type: application/json
</code></pre><p>HTTP POST Body</p>
<pre><code class="lang-json">{
    &quot;origins&quot;: [{
        &quot;latitude&quot;: 47.6044,
        &quot;longitude&quot;: -122.3345
    },
    {
        &quot;latitude&quot;: 47.6731,
        &quot;longitude&quot;: -122.1185
    },
    {
        &quot;latitude&quot;: 47.6149,
        &quot;longitude&quot;: -122.1936
    }],
    &quot;destinations&quot;: [{
        &quot;latitude&quot;: 45.5347,
        &quot;longitude&quot;: -122.6231
    }, 
    {
        &quot;latitude&quot;: 47.4747,
        &quot;longitude&quot;: -122.2057
    }],
    &quot;travelMode&quot;: &quot;driving&quot;,
    &quot;startTime&quot;: &quot;2017-06-15T13:00:00-07:00&quot;
}
</code></pre><p><strong>JSON Response</strong></p>
<pre><code class="lang-json">{
    &quot;authenticationResultCode&quot;: &quot;ValidCredentials&quot;,
    &quot;brandLogoUri&quot;: &quot;http:\/\/dev.virtualearth.net\/Branding\/logo_powered_by.png&quot;,
    &quot;copyright&quot;: &quot;Copyright © 2017 Microsoft and its suppliers. All rights reserved. This API cannot be accessed and the content and any results may not be used, reproduced or transmitted in any manner without express written permission from Microsoft Corporation.&quot;,
    &quot;resourceSets&quot;: [
        {
            &quot;estimatedTotal&quot;: 1,
            &quot;resources&quot;: [
                {
                    &quot;__type&quot;: &quot;DistanceMatrixAsyncStatus:http:\/\/schemas.microsoft.com\/search\/local\/ws\/rest\/v1&quot;,
                    &quot;callbackInSeconds&quot;: 10,
                    &quot;callbackUrl&quot;: &quot;https:\/\/dev.virtualearth.net\/REST\/v1\/Routes\/DistanceMatrixAsyncCallback?key= xxxxxxxxxxxxxxxxxx&amp;requestId=9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&quot;,
                    &quot;isAccepted&quot;: true,
                    &quot;requestId&quot;: &quot;9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&quot;
                }
            ]
        }
    ],
    &quot;statusCode&quot;: 200,
    &quot;statusDescription&quot;: &quot;OK&quot;,
    &quot;traceId&quot;: &quot;b0d0126ef8984228b21d37194fbf72a7|BN20121764|7.7.0.0|&quot;
}
</code></pre><p><strong>XML Response</strong></p>
<p>Add <code>&amp;output=xml</code> to the URL above to get the XML response.</p>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;Response xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://schemas.microsoft.com/search/local/ws/rest/v1&quot;&gt;
  &lt;Copyright&gt;Copyright © 2017 Microsoft and its suppliers. All rights reserved. This API cannot be accessed and the content and any results may not be used, reproduced or transmitted in any manner without express written permission from Microsoft Corporation.&lt;/Copyright&gt;
  &lt;BrandLogoUri&gt;http://dev.virtualearth.net/Branding/logo_powered_by.png&lt;/BrandLogoUri&gt;
  &lt;StatusCode&gt;200&lt;/StatusCode&gt;
  &lt;StatusDescription&gt;OK&lt;/StatusDescription&gt;
  &lt;AuthenticationResultCode&gt;ValidCredentials&lt;/AuthenticationResultCode&gt;
  &lt;TraceId&gt;cc062945da9d46a58717cffb4b5fb019|BN20190653|7.7.0.0|&lt;/TraceId&gt;
  &lt;ResourceSets&gt;
    &lt;ResourceSet&gt;
      &lt;EstimatedTotal&gt;1&lt;/EstimatedTotal&gt;
      &lt;Resources&gt;
        &lt;Resource xsi:type=&quot;DistanceMatrixAsyncStatus&quot;&gt;
          &lt;IsAccepted&gt;true&lt;/IsAccepted&gt;
          &lt;IsCompleted&gt;false&lt;/IsCompleted&gt;
          &lt;CallbackInSeconds&gt;10&lt;/CallbackInSeconds&gt;
          &lt;CallbackUrl&gt;https://dev.virtualearth.net/REST/v1/Routes/DistanceMatrixAsyncCallback?key=xxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;amp;requestId=af2ee392-cb20-42f4-80e8-24c0e4e46529&lt;/CallbackUrl&gt;
          &lt;RequestId&gt;9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&lt;/RequestId&gt;
          &lt;ResultUrl /&gt;
        &lt;/Resource&gt;
      &lt;/Resources&gt;
    &lt;/ResourceSet&gt;
  &lt;/ResourceSets&gt;
&lt;/Response&gt;
</code></pre><h2 id="status-request">Status Request</h2>
<p>When making an asynchronous request to the distance matrix service the initial response includes a <code>DistanceMatrixAsyncStatus</code> which includes a unique <code>requestId</code>. This <code>requestId</code> can be used to check the status of the asynchronous distance matrix request by using the following HTTP GET URL. The response from the initial request and all responses using the following status request URL will include a field which indicates an estimated amount of time remaining until the requested distance matrix has been generated. The responses shown below in both XML and JSON formats are example of the status returned when the distance matrix request has been completed.</p>
<p><strong>HTTP GET Request URL</strong></p>
<pre><code>https://dev.virtualearth.net/REST/v1/Routes/DistanceMatrixAsyncCallback?requestId=9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&amp;key=BingMapsKey
</code></pre><p><strong>JSON Response</strong></p>
<pre><code class="lang-json">{
    &quot;authenticationResultCode&quot;: &quot;ValidCredentials&quot;,
    &quot;brandLogoUri&quot;: &quot;http:\/\/dev.virtualearth.net\/Branding\/logo_powered_by.png&quot;,
    &quot;copyright&quot;: &quot;Copyright © 2017 Microsoft and its suppliers. All rights reserved. This API cannot be accessed and the content and any results may not be used, reproduced or transmitted in any manner without express written permission from Microsoft Corporation.&quot;,
    &quot;resourceSets&quot;: [
        {
            &quot;estimatedTotal&quot;: 1,
            &quot;resources&quot;: [
                {
                    &quot;__type&quot;: &quot;DistanceMatrixAsyncStatus:http:\/\/schemas.microsoft.com\/search\/local\/ws\/rest\/v1&quot;,
                    &quot;callbackInSeconds&quot;: -1,
                    &quot;callbackUrl&quot;: &quot;https:\/\/dev.virtualearth.net\/REST\/v1\/Routes\/DistanceMatrixAsyncCallback?key=xxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;requestId=9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&quot;,
                    &quot;isAccepted&quot;: true,
                    &quot;isCompleted&quot;: true,
                    &quot;requestId&quot;: &quot;9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&quot;,
                    &quot;resultUrl&quot;: &quot;https:\/\/routematrix.blob.core.windows.net\/finalresults\/9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&quot;
                }
            ]
        }
    ],
    &quot;statusCode&quot;: 200,
    &quot;statusDescription&quot;: &quot;OK&quot;,
    &quot;traceId&quot;: &quot;165140fdda774fa9bded630f97cd96e5|BN20121764|7.7.0.0|&quot;
}
</code></pre><p><strong>XML Response</strong></p>
<p>Add <code>&amp;output=xml</code> to the URL above to get the XML response.</p>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;Response xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://schemas.microsoft.com/search/local/ws/rest/v1&quot;&gt;
  &lt;Copyright&gt;Copyright © 2017 Microsoft and its suppliers. All rights reserved. This API cannot be accessed and the content and any results may not be used, reproduced or transmitted in any manner without express written permission from Microsoft Corporation.&lt;/Copyright&gt;
  &lt;BrandLogoUri&gt;http://dev.virtualearth.net/Branding/logo_powered_by.png&lt;/BrandLogoUri&gt;
  &lt;StatusCode&gt;200&lt;/StatusCode&gt;
  &lt;StatusDescription&gt;OK&lt;/StatusDescription&gt;
  &lt;AuthenticationResultCode&gt;ValidCredentials&lt;/AuthenticationResultCode&gt;
  &lt;TraceId&gt;e08a8dc9cea749e1ac165a4a38a9fea8|BN20130621|7.7.0.0|&lt;/TraceId&gt;
  &lt;ResourceSets&gt;
    &lt;ResourceSet&gt;
      &lt;EstimatedTotal&gt;1&lt;/EstimatedTotal&gt;
      &lt;Resources&gt;
        &lt;Resource xsi:type=&quot;DistanceMatrixAsyncStatus&quot;&gt;
          &lt;IsAccepted&gt;true&lt;/IsAccepted&gt;
          &lt;IsCompleted&gt;true&lt;/IsCompleted&gt;
          &lt;CallbackInSeconds&gt;-1&lt;/CallbackInSeconds&gt;
          &lt;CallbackUrl&gt;https://dev.virtualearth.net/REST/v1/Routes/DistanceMatrixAsyncCallback?key=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;amp;requestId=9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&lt;/CallbackUrl&gt;
          &lt;RequestId&gt;9d721ef1-8ae1-4aef-a9b3-9badf01b4b1d&lt;/RequestId&gt;
          &lt;ResultUrl&gt;https://routematrix.blob.core.windows.net/finalresults/af2ee392-cb20-42f4-80e8-24c0e4e46529&lt;/ResultUrl&gt;
        &lt;/Resource&gt;
      &lt;/Resources&gt;
    &lt;/ResourceSet&gt;
  &lt;/ResourceSets&gt;
&lt;/Response&gt;
</code></pre><h2 id="downloaded-results">Downloaded Results</h2>
<p>When an asynchronous distance matrix request has completed, the status response will include a <code>resultUrl</code> field which can be used to download the requested distance matrix result. The following is the distance matrix result that would be downloaded when using the <code>resultUrl</code>. The downloaded distance matrix results are only available in JSON format.</p>
<p><strong>JSON Response</strong></p>
<pre><code class="lang-json">{
    &quot;origins&quot;: [
        {
            &quot;latitude&quot;: 47.6044,
            &quot;longitude&quot;: -122.3345
        }, {
            &quot;latitude&quot;: 47.6731,
            &quot;longitude&quot;: -122.1185
        }, {
            &quot;latitude&quot;: 47.6149,
            &quot;longitude&quot;: -122.1936
        }
    ],
    &quot;destinations&quot;: [
        {
            &quot;latitude&quot;: 45.5347,
            &quot;longitude&quot;: -122.6231
        }, {
            &quot;latitude&quot;: 47.4747,
            &quot;longitude&quot;: -122.2057
        }
    ],
    &quot;results&quot;: [
        {
            &quot;originIndex&quot;: 1,
            &quot;destinationIndex&quot;: 1,
            &quot;travelDistance&quot;: 28.43,
            &quot;travelDuration&quot;: 1318,
            &quot;totalWalkDuration&quot;: 0,
            &quot;hasError&quot;: false,
            &quot;departureTime&quot;: &quot;2017-06-15T20:00:00.0000000+00:00&quot;
        }, {
            &quot;originIndex&quot;: 1,
            &quot;destinationIndex&quot;: 0,
            &quot;travelDistance&quot;: 296.035,
            &quot;travelDuration&quot;: 11618,
            &quot;totalWalkDuration&quot;: 0,
            &quot;hasError&quot;: false,
            &quot;departureTime&quot;: &quot;2017-06-15T20:00:00.0000000+00:00&quot;
        }, {
            &quot;originIndex&quot;: 0,
            &quot;destinationIndex&quot;: 1,
            &quot;travelDistance&quot;: 23.269,
            &quot;travelDuration&quot;: 1209,
            &quot;totalWalkDuration&quot;: 0,
            &quot;hasError&quot;: false,
            &quot;departureTime&quot;: &quot;2017-06-15T20:00:00.0000000+00:00&quot;
        }, {
            &quot;originIndex&quot;: 0,
            &quot;destinationIndex&quot;: 0,
            &quot;travelDistance&quot;: 281.244,
            &quot;travelDuration&quot;: 10893,
            &quot;totalWalkDuration&quot;: 0,
            &quot;hasError&quot;: false,
            &quot;departureTime&quot;: &quot;2017-06-15T20:00:00.0000000+00:00&quot;
        }, {
            &quot;originIndex&quot;: 2,
            &quot;destinationIndex&quot;: 1,
            &quot;travelDistance&quot;: 18.064,
            &quot;travelDuration&quot;: 854,
            &quot;totalWalkDuration&quot;: 0,
            &quot;hasError&quot;: false,
            &quot;departureTime&quot;: &quot;2017-06-15T20:00:00.0000000+00:00&quot;
        }, {
            &quot;originIndex&quot;: 2,
            &quot;destinationIndex&quot;: 0,
            &quot;travelDistance&quot;: 285.669,
            &quot;travelDuration&quot;: 11153,
            &quot;totalWalkDuration&quot;: 0,
            &quot;hasError&quot;: false,
            &quot;departureTime&quot;: &quot;2017-06-15T20:00:00.0000000+00:00&quot;
        }
    ]
}
</code></pre><h2 id="see-also">See Also</h2>
<ul>
<li><a href="using-the-rest-services-with-net.html">Using the REST Services with .NET</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/MicrosoftDocs/bingmaps-docs/blob/master/BingMaps/rest-services/distance-matrix-asynchronous-example.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
